<!DOCTYPE html><html lang="en"><head><base href="/advanced-static-site"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0"/><meta name="description" content="Introduction description, how-to, article custom elements, canvas, es6"><meta name="theme-color" content="#0d5173"><meta name="msapplication-navbutton-color" content="#0d5173"><meta name="apple-mobile-web-app-status-bar-style" content="#0d5173"><meta property="og:image" content="https://chpmnrssll.github.io/assets/images/pixelavatar.png"/><link rel="alternate" type="application/rss+xml" title="Russell Chapman" href="/advanced-static-site/feed.xml"><title>Image to ASCII | Russell Chapman</title><meta name="generator" content="Jekyll v3.6.3"/><meta property="og:title" content="Image to ASCII"/><meta name="author" content="Russell Chapman"/><meta property="og:locale" content="en"/><meta name="description" content="Introduction description, how-to, article custom elements, canvas, es6"/><meta property="og:description" content="Introduction description, how-to, article custom elements, canvas, es6"/><link rel="canonical" href="https://chpmnrssll.github.io/advanced-static-site/article/2017/10/12/Ascii.html"/><meta property="og:url" content="https://chpmnrssll.github.io/advanced-static-site/article/2017/10/12/Ascii.html"/><meta property="og:site_name" content="Russell Chapman"/><meta property="og:image" content="https://chpmnrssll.github.io/advanced-static-site/assets/images/backgrounds/ascii.jpg"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2017-10-12T00:00:00+00:00"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@chpmnrssll"/><meta name="twitter:creator" content="@Russell Chapman"/> <script type="application/ld+json">
{"description":"Introduction description, how-to, article custom elements, canvas, es6","headline":"Image to ASCII","dateModified":"2017-10-12T00:00:00+00:00","datePublished":"2017-10-12T00:00:00+00:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://chpmnrssll.github.io/advanced-static-site/article/2017/10/12/Ascii.html"},"image":"https://chpmnrssll.github.io/advanced-static-site/assets/images/backgrounds/ascii.jpg","url":"https://chpmnrssll.github.io/advanced-static-site/article/2017/10/12/Ascii.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://chpmnrssll.github.io/advanced-static-site/assets/images/pixelavatar.png"},"name":"Russell Chapman"},"author":{"@type":"Person","name":"Russell Chapman"},"@context":"http://schema.org"}</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-102033116-5"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-36647530-3")</script><meta name="theme-color" content="#537895"/><link rel="manifest" href="/advanced-static-site/assets/manifest.e5668bf01f9fcfa8cb4d264da00e63e2.json"/><link rel="apple-touch-icon" sizes="57x57" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-icon-180x180.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="advanced-static-site"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#fff"><meta name="application-name" content="advanced-static-site"><link rel="icon" type="image/png" sizes="32x32" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/favicon-16x16.png"><link rel="shortcut icon" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/favicon.ico"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-startup-image-320x460.png"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-startup-image-640x920.png"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-startup-image-640x1096.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-startup-image-750x1294.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 3)" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-startup-image-1182x2208.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 3)" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-startup-image-1242x2148.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 1)" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-startup-image-748x1024.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 1)" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-startup-image-768x1004.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-startup-image-1496x2048.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" href="/advanced-static-site/assets/icons-17561a1604d464cca4e0b5b5384dfa51/apple-touch-startup-image-1536x2008.png"><link href="/advanced-static-site/assets/app.css" rel="stylesheet"></head><body><nav class="navigation navigation--hidden" role="navigation"> <button class="navigation__button navigation__button--close" aria-label="Close Navigation"> <i class="fa fa-times">x</i> </button> <section class="navigation__categories"><h4>Categories</h4> <a class="navigation__link" href="/advanced-static-site/">Home</a> <a class="navigation__link" href="/advanced-static-site/articles/">Articles</a> <a class="navigation__link" href="/advanced-static-site/demo/">Demos</a> <a class="navigation__link" href="/advanced-static-site/news/">News</a> <a class="navigation__link" href="/advanced-static-site/about/">About</a> </section> </nav><nav class="navigation__overlay"> <button class="navigation__button navigation__button--open" aria-label="Open Navigation"> <i class="fa fa-bars">=</i> </button> <button class="navigation__button navigation__button--update navigation--hidden" aria-label="Updates Available"> <i class="fa fa-refresh"></i> </button> <button class="navigation__button navigation__button--top" aria-label="Scroll to top"> <i class="fa fa-chevron-up"></i> </button> </nav><main> <section class="content"> <article class="article" itemscope itemtype="http://schema.org/BlogPosting"><div class="article__image gradient-overlay--alt"> <img class="article__image" itemprop="image" src="/advanced-static-site/assets/images/backgrounds/ascii.jpg" alt="alt"></div> <header class="article__header"><h1 class="article__title animated-headline fit__text" itemprop="name headline">Image to ASCII</h1><div class="article__meta"> <time datetime="2017-10-12T00:00:00+00:00" itemprop="datePublished"> Oct 12, 2017 </time></div> </header><div class="article__content" itemprop="articleBody"><h1 id="introduction">Introduction</h1><ul><li>description, how-to, article</li><li>custom elements, canvas, es6</li></ul><p>This article is a how-to for some of those out there old enough to remember the heyday of BBS’es and MUDs. I was always fascinated by the talent of the folks good enough to make ASCII art that looked like real images. I decided to create an algorithm that would convert a real image into its ASCII representation. There should be some little tidbits of code that you might enjoy, even if you’re not a fan of the early internet.</p><h1 id="background">Background</h1><ul><li>history<ul><li>bbs door games</li><li>roguelike</li><li>terminal</li><li>compression</li><li>downsampling</li></ul></li><li>generateCharacters<ul><li>populates the character array with { character, average: { lightness, r, g, b, a }} objects</li></ul></li><li>getCharacterAverage<ul><li>draws a white character on a black background in a small canvas</li><li>returns this characters’ average lightness from getImageDataAverage</li></ul></li><li>getImageDataAverage<ul><li>returns the average lightness and rgb for imageData</li></ul></li><li>convertImage<ul><li>iterates over a canvas in cell.width by cell.height blocks calling getMatchingCharacter</li><li>returns matching characters array for entire image</li></ul></li><li>getMatchingCharacter<ul><li>returns a character that matches this imageData block lightness</li></ul></li><li>based on the lightness for each pixel, output ASCII characters that have a matching lightness value</li><li>calculate character lightness, find matching character for each pixel</li></ul><p>Lightness is how bright a white character will appear on a black background. For example, the character “#” appears to be much brighter than “:”.</p><p>You can experiment with changing the character constants in the code to output different effects. I got particularly interesting results when I reversed the order of the output characters to get a “negative” effect.</p><h1 id="using-the-code">Using the code</h1><p>I’ve documented the code in the solution, but I will include my favorite method here for review. This method is the third type of ASCII art (mentioned above). It will take a posted file (via HTTP), read the pixels in, get the grayscale value of each pixel, then find the appropriate ASCII character to output.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//% highlight javascript linenos %}</span>
<span class="c1">// % endhighlight %}</span>
</code></pre></div></div><p>In a nutshell, we’re doing the following:</p><ul><li>Convert the Image object into a Bitmap object</li><li>Enclose the output in HTML paragraph tags</li><li>Loop through each pixel in the bitmap, and obtain the color</li><li>Strip the color information from the pixel (see below)</li><li>Find the character to use based on the new shade (see below)</li><li>Aggregate all of the characters, then return the HTML</li></ul><h1 id="converting-to-pixels-to-lightness-values">Converting to pixels to lightness values</h1><p>The simplest way to get a lightness value is by averaging all of the pixels’ rgb components.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code></code></pre></div></div><h1 id="converting-lightness-values-to-characters">Converting lightness values to characters</h1><p>In order to convert the lightness value to a character, we average blocks of pixels cell.width by cell.height and find a character in the array with a matching value. The values I’ve included with the demo code seem to work fairly well, but feel free to experiment with different character sets.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code></code></pre></div></div><p>You can use as few or as many constants as you like. 9 seemed to provide good results. The constant values that I chose are are as follows:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">getCharacterLightness</span><span class="p">(</span><span class="nx">character</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// clear canvas (black)</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s2">"#000"</span><span class="p">;</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>

  <span class="c1">// draw the character (white)</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s2">"#FFF"</span><span class="p">;</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="nx">character</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>

  <span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getImageData</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">height</span><span class="p">).</span><span class="nx">data</span><span class="p">,</span> <span class="nx">avg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="c1">// running average of lightness for this imageData block</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">lightness</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3</span><span class="p">;</span>
    <span class="nx">avg</span> <span class="o">+=</span> <span class="nx">lightness</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">avg</span> <span class="o">/=</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">/</span> <span class="mi">4</span><span class="p">);</span>
  <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">avg</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span> <span class="mi">255</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div><p>So now, as we get the gray shade for each pixel, we just output the corresponding ASCII character. The logo of my favorite team (Denver Broncos) now appears as follows:</p><h1 id="points-of-interest">Points of interest</h1><p>Many of you will notice that I did not use an HTML Text Writer to build the HTML. Simply put, it was more overhead than I needed. StringBuilder seemed to work very well, and though it doesn’t afford me the luxury of ensuring I have the right formatting, it is by far the fastest solution.</p><p>Styling is handled by a CSS file (included). For this reason, the “class=’ascii_art’” bit was added to the opening paragraph tag. You may notice that the VS2005 IDE flags the “line-spacing” attribute in the CSS designer. Don’t worry… both IE and Firefox know how to handle it. Line spacing keeps the characters close so there is not a lot of whitespace between the lines. Also, it is important to use a MONOTYPE font (Lucida Console, Courier New, Terminal, etc.) for the font, otherwise your image will be extremely skewed.</p><p>Currently, the solution just performs a Response.Write() of the HTML to the Default.aspx page on postback. This could obviously be modified to post to a separate page, but I chose not to for purposes of simplicity and illustration.</p><p>Happy ASCII’ing!</p><ul><li><a href="/demo/js-ascii/">Demo</a></li><li><a href="https://stackoverflow.com/questions/394882/how-do-ascii-art-image-conversion-algorithms-work">ASCII art image conversion algorithms</a></li><li><a href="https://github.com/EnotionZ/jscii/blob/master/src/jscii.js">jscii.js</a></li><li><a href="https://github.com/aemkei/ascii.js/blob/master/asciify.js">asciify.js</a></li><li><a href="https://www.codeproject.com/Articles/20435/Using-C-To-Generate-ASCII-Art-From-An-Image">Using C# To Generate ASCII Art From An Image</a></li></ul></div><div class="article__comments"></div> </article><footer class="footer"><div class="footer__container"> Made with <a href="http://jekyllrb.com"> <img src="/advanced-static-site/assets/images/jekyll-logo.png" class="footer__logo-img" alt="Jekyll"> </a> <a href="https://webpack.js.org"> <img src="/advanced-static-site/assets/images/webpack.png" class="footer__logo-img" alt="Webpack"> </a> <a href="https://popmotion.io"> <img src="/advanced-static-site/assets/images/popmotion.png" class="footer__logo-img" alt="Popmotion"> </a></div> </footer></section> </main> <script>"use strict";"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/advanced-static-site/service-worker.js").then(function(e){e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){switch(n.state){case"installed":navigator.serviceWorker.controller?console.log("New or updated content is available."):console.log("Content is now available offline!");break;case"redundant":console.error("The installing service worker became redundant.")}}}})["catch"](function(e){console.error("Error during service worker registration:",e)})})</script><script src="/advanced-static-site/assets/app-97acb264c3c03c2ceb94.bundle.js"></script></body></html>